[{"body":"When selecting a medicine from the list while adding a new medicine the \"known as\"and \"brand\" fields are populated when focus changes from the drop-down, it is not good UX and instead of should happen on selection of a medicine in the deep down list ","number":66,"title":"Entering a new medication should populate all fields on medicine selection"},{"body":"Add ACE inhibitors like coversyl and beta blockers like propranolol and bisoprolol.\n\nIdeally users would be able to add a medicine not listed but maybe that is a longer term piece of work moving the medicine to the database and out of the current class.","number":64,"title":"Add new classes of drugs to the medication list"},{"body":"Medicine dosage changes over time, the database and API were setup to sort such changes but the UI does not have a way to navigate to a page where the schedule can be changed. \n\nIt be possible to switch from a static dose to a varying patterned dose and from one pattern to another as the prescribed dosage changes","number":62,"title":"The web UI does not exist a way to edit the medicine dosage schedule"},{"body":"After several minutes working in the web application it starts popping up 401 messages, even though the user is actively using the application. \n\nWhen a user is active the refresh token should extend the users session and keep their login valid. \n\nIf we don't have any kind of refresh mechanism when a user no longer has a valid session/cookie/token the user should be logged out and forced back to the login page, at the moment the user can still navigate from page to page getting 401 toasts and fully rendered but empty pages which is terrible UX.","number":60,"title":"Refresh token mechanism in web project not working"},{"body":"When navigating to an INR test to edit it and saving our cancelling it goes back to the INR list page and the size of the page in the list defaults back to 10 items.\n\nThe page should know more about it's state and return to the same location on the page with the same number of items displayed on the page. \n\nPropose a design which can be refused across the application to make the UI remember state when working server side rendering or wasm modes.","number":58,"title":"INR list page should remember how many items to show in the list and where on the page it was"},{"body":"At the top of the INR list page there is commented code \n/ Preserve PublicId (GUID) for client-side navigation and API calls // (use typed PublicId from the API DTO) PublicId = r.PublicId,\n\nIt should be removed\n\nOn the homepage there is a } which should not be displayed.","number":56,"title":"INR list page and homepage shows commented code"},{"body":"2 pipelines are failing after merging  #52 but local copy of main builds with the same command dotnet build BloodThinnerTracker.sln --no-restore --configuration Release with no errors.\n\nExplain why the failure occurs, one hint, i unloaded the postgresql project locally pending the new version of the package being released, but the error is reported in sqlite and on a line which is 200 lines higher than the file actually has.\n\nhttps://github.com/MarkZither/blood_thinner_INR_tracker/actions/runs/19514626265\n20 [linux/amd64 build 5/5] RUN dotnet publish src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj -c Release -o /app --no-restore\n20 17.30   BloodThinnerTracker.ServiceDefaults -> /src/src/BloodThinnerTracker.ServiceDefaults/bin/Release/net10.0/BloodThinnerTracker.ServiceDefaults.dll\n20 18.63   BloodThinnerTracker.Shared -> /src/src/BloodThinnerTracker.Shared/bin/Release/net10.0/BloodThinnerTracker.Shared.dll\n20 22.06   BloodThinnerTracker.Data.Shared -> /src/src/BloodThinnerTracker.Data.Shared/bin/Release/net10.0/BloodThinnerTracker.Data.Shared.dll\n20 25.56   BloodThinnerTracker.Data.SQLite -> /src/src/BloodThinnerTracker.Data.SQLite/bin/Release/net10.0/BloodThinnerTracker.Data.SQLite.dll\n20 25.81   BloodThinnerTracker.Data.SqlServer -> /src/src/BloodThinnerTracker.Data.SqlServer/bin/Release/net10.0/BloodThinnerTracker.Data.SqlServer.dll\n20 26.69 /src/src/BloodThinnerTracker.Api/Services/DatabaseConfigurationService.cs(793,10): error CS1513: } expected [/src/src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj]\n20 26.69 /src/src/BloodThinnerTracker.Api/Services/DatabaseConfigurationService.cs(808,5): error CS1519: Invalid token '}' in a member declaration [/src/src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj]\n20 ERROR: process \"/bin/sh -c dotnet publish src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj -c Release -o /app --no-restore\" did not complete successfully: exit code: 1\n19 [linux/arm64 build 4/5] RUN dotnet restore src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj\n19 CANCELED\n13 [linux/arm64 runtime  2/10] RUN apt-get update && apt-get install -y curl ca-certificates gnupg gosu     && curl -sL https://aka.ms/InstallAzureCLIDeb | bash     && apt-get clean\n13 39.40 Reading package lists...\n13 CANCELED\n\nci-cd.yml https://github.com/MarkZither/blood_thinner_INR_tracker/actions/runs/19514626230/job/55863073612\nRun dotnet build BloodThinnerTracker.sln --no-restore --configuration Release\n  BloodThinnerTracker.ServiceDefaults -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.ServiceDefaults/bin/Release/net10.0/BloodThinnerTracker.ServiceDefaults.dll\n  BloodThinnerTracker.Shared -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Shared/bin/Release/net10.0/BloodThinnerTracker.Shared.dll\n  BloodThinnerTracker.Mcp -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Mcp/bin/Release/net10.0/BloodThinnerTracker.Mcp.dll\n  BloodThinnerTracker.Cli -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Cli/bin/Release/net10.0/BloodThinnerTracker.Cli.dll\n  BloodThinnerTracker.Data.Shared -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Data.Shared/bin/Release/net10.0/BloodThinnerTracker.Data.Shared.dll\n  BloodThinnerTracker.Data.SqlServer -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Data.SqlServer/bin/Release/net10.0/BloodThinnerTracker.Data.SqlServer.dll\n  BloodThinnerTracker.Data.SQLite -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Data.SQLite/bin/Release/net10.0/BloodThinnerTracker.Data.SQLite.dll\nError: /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Api/Services/DatabaseConfigurationService.cs(793,10): error CS1513: } expected [/home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj]\nError: /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Api/Services/DatabaseConfigurationService.cs(808,5): error CS1519: Invalid token '}' in a member declaration [/home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Api/BloodThinnerTracker.Api.csproj]\n  BloodThinnerTracker.Web -> /home/runner/work/blood_thinner_INR_tracker/blood_thinner_INR_tracker/src/BloodThinnerTracker.Web/bin/Release/net10.0/BloodThinnerTracker.Web.dll\n\nBuild FAILED.","number":54,"title":"Docker and ci/cd workflow failing on main"},{"body":"We observe many CS1591 warnings (missing XML comments) across the public API surface. To reduce noise while delivering feature work, we temporarily suppressed CS1591 in several `Directory.Build.props` files. This issue tracks the remediation needed to restore XML documentation checks and remove the temporary suppression.\n\nBackground\n---------\n- Temporary suppression was added to the following files on branch `009-bug-fix-editing` to reduce build noise while implementing feature work:\n  - `Directory.Build.props` (root) â€” already contained `1591` entry\n  - `src/BloodThinnerTracker.Api/Directory.Build.props`\n  - `src/BloodThinnerTracker.Web/Directory.Build.props`\n  - `src/BloodThinnerTracker.Data.PostgreSQL/Directory.Build.props`\n  - `src/BloodThinnerTracker.Data.SqlServer/Directory.Build.props`\n  - `src/BloodThinnerTracker.Data.SQLite/Directory.Build.props`\n\nGoal\n----\nRemove the temporary CS1591 suppression and restore XML documentation enforcement for public API surfaces. Improve or add XML documentation comments where required so CI can enforce CS1591 without generating excessive noise.\n\nProposed plan\n-------------\n1. Triage and categorize CS1591 warnings by project and type (controllers, DTOs, services).\n2. Assign owners for each project area to add missing XML comments or mark internal types as internal.\n3. Add short-term exemptions for third-party-generated code if necessary, but avoid global suppressions.\n4. Remove the `NoWarn` entries for CS1591 and run CI; fix any remaining documentation issues.\n5. Close this issue when CS1591 no longer appears in CI and all planned doc work is merged.\n\nAcceptance criteria\n-------------------\n- `Directory.Build.props` and project-level `NoWarn` no longer include `1591`/`CS1591`.\n- CI build shows zero CS1591 warnings for the public API projects.\n- A small PR closing this issue updates or adds XML comments as needed and references this issue.\n\nNotes\n-----\n- The temporary suppression was timeboxed and referenced in `specs/009-bug-fix-editing/issue-improve-api-docs.md` and task T009-014.\n- If any code is intentionally public surface but not documented, owners must add a short XML doc explaining API intent before removal of suppression.\n\nRelated drafts and context:\n- `specs/009-bug-fix-editing/issue-improve-api-docs.md`","number":51,"title":"Improve API XML documentation and remove CS1591 suppression"},{"body":"Problem\n- Currently `ForwardedHeadersOptions.KnownProxies` is cleared in `Program.cs` for development which accepts forwarded headers from local proxies. In production this must be configured with trusted proxy IPs or networks, otherwise request forgery can occur.\n\nProposal\n- Read `ForwardedHeaders:KnownProxies` (array of IP addresses) and `ForwardedHeaders:KnownNetworks` (array of CIDR notation networks) from configuration and populate `ForwardedHeadersOptions` at startup when not in Development.\n- Add `appsettings.Production.json` example with `ForwardedHeaders` section.\n- Add runtime warning/log when running in non-Development and no proxies/networks are configured.\n\nAcceptance Criteria\n- Create code changes in `src/BloodThinnerTracker.Web/Program.cs` and `src/BloodThinnerTracker.Api/Program.cs` to parse configuration and add proxies/networks to `ForwardedHeadersOptions` when present.\n- Add `docs/deployment/forwarded-headers.md` describing how to obtain proxy IPs (Traefik service network, Kubernetes Ingress controller, cloud load balancer) and an appsettings example.\n- Add unit test(s) validating the parsing of configured proxies and networks (if feasible).\n\nFiles to change\n- `src/BloodThinnerTracker.Web/Program.cs`\n- `src/BloodThinnerTracker.Api/Program.cs`\n- `docs/deployment/forwarded-headers.md` (new)\n\nNotes\n- This issue is targeted for follow-up after merging the current `feature/forwarded-headers-proxy` PR; leave `KnownProxies.Clear()` for development flows.\n\nTags: security, infra, production, proxy\r\n","number":49,"title":"chore(proxy): configure KnownProxies/KnownNetworks from configuration for production"},{"body":"Parent epic for deferred documentation, CI wiring, and e2e coverage tasks. Children:\n- #31 T021 Documentation updates\n- #32 T022 Run full test suite locally + report\n- #33 T023 PR checklist automation\n- #34 T024 Add coverage measurement to CI\n\nSee specs/006-title-bugfix-returnurl/tasks.md for details.","number":36,"title":"Epic: Documentation, CI, and E2E follow-up (T021-T024)"},{"body":"Parent epic for security enforcement and tests related to ReturnUrl validation across web entry points. Children:\n- #26 T012 Enforce ReturnUrl validation policy\n- #27 T013 Redirect to safe default + log\n- #28 T014 Unit tests for invalid patterns\n- #29 T015 Playwright negative external URL blocked (deferred)\n- #30 T016 Playwright negative encoding tests (deferred)\n\nSee specs/006-title-bugfix-returnurl/tasks.md for details.","number":35,"title":"Epic: Enforce ReturnUrl validation across web entry points (T012-T016)"},{"body":"Add Coverlet + ReportGenerator to CI and ensure coverage artifacts are uploaded. Update PR template to include coverage summary for changed projects.","number":34,"title":"T024: Add coverage measurement to CI"},{"body":"Add PR checklist item requiring any configuration changes to follow repository standards (strongly-typed options, documented default values). Update PR template accordingly.","number":33,"title":"T023: PR checklist item for configuration changes"},{"body":"Run full test suite (unit + Playwright) and verify new tests pass. Publish results and test matrix in the PR description.\\n\\nAcceptance: CI run logs attached and tests pass.","number":32,"title":"T022: Run full test suite & report"},{"body":"Add docs/api/returnurl.md and update specs/006-title-bugfix-returnurl/quickstart.md with exact Playwright run instructions and notes.\\n\\nAcceptance: docs provide clear instructions for Playwright runs and configuration notes.","number":31,"title":"T021: Docs - returnurl guide & quickstart"},{"body":"Add Playwright tests for protocol-relative and double-encoded ReturnUrl payloads in \tests/playwright/returnurl/NegativeEncodingTests.cs.\\n\\nSee: specs/006-title-bugfix-returnurl/tasks.md#phase-4 for context.","number":30,"title":"T016: Playwright negative tests - protocol-relative & double-encoded"},{"body":"Create a Playwright test that verifies external redirect attempts are blocked and recorded. Add test at \tests/playwright/returnurl/ExternalBlockTests.cs.\\n\\nSee: specs/006-title-bugfix-returnurl/tasks.md#phase-4 for context.","number":29,"title":"T015: Playwright negative test - external URL blocked"},{"body":"Add unit tests for invalid ReturnUrl patterns including external absolute URLs, protocol-relative (//evil), double-encoded payloads and malformed URLs in \tests/BloodThinnerTracker.Web.Tests/ReturnUrl/InvalidReturnUrlTests.cs.\\n\\nSee: specs/006-title-bugfix-returnurl/tasks.md#phase-4 for context.","number":28,"title":"T014: Unit tests for invalid ReturnUrl patterns"},{"body":"Ensure that when a ReturnUrl is invalid it redirects to the safe default (/dashboard) and logs a security event at Error level using ILogger.\\n\\nSee: specs/006-title-bugfix-returnurl/tasks.md#phase-4 for context.\\n\\nAcceptance: invalid ReturnUrl flows redirect to /dashboard and emit a LogError with EventId ReturnUrlBlocked.","number":27,"title":"T013: Redirect to safe default and log invalid ReturnUrl events"},{"body":"Enforce the ReturnUrl validation policy (relative-only) in all web entry points that accept \returnUrl using ReturnUrlValidator.\\n\\nSee: specs/006-title-bugfix-returnurl/tasks.md#phase-4 for context.\\n\\nAcceptance: all places that accept \returnUrl validate and reject absolute and protocol-relative URLs.","number":26,"title":"T012: Enforce ReturnUrl validation across web entry points"},{"body":"Investigate and plan an internal only deployment strategy. \n\nThe deployment will be too existing raspberry pi infrastructure, it will be bare metal, no docker. The database will be sqlite, important to keep it persisted between updates. \n\nSelf contained dotnet application is preferred to avoid framework deployment, single file and aot can be considered if there isn't too much impact.\n\nEverything will be on my tailnet so access can be via 192.168.n.n or talescale 100.n.n.n or name.tnet address or magic DNS.","number":16,"title":"Simple initial internal only deployment strategy"},{"body":"Investigate and write a plan to add PWA and web Assembly support to the blazor web project. Pay particular attention to the use of mudblazor and the impact of its server rendering requirements.","number":14,"title":"Web Assembly and PWA support for blazor web project"}]
